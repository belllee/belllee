<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>基于karma+jasmine的web前端自动化测试 | 李忠伟的个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="本文介绍了基于karma+jasmine的web前端自动化测试的方案和详细操作指导。 名词解释 Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。Node.js 使用了一个事件驱动、非阻塞式 I/O 的模型，使其轻量又高效。Node.js 的包管理器 npm，是全球最大的开源库生态系统。 Karma是一个基于Node.js的JavaScript测试执行过程管理">
<meta name="keywords" content="工具,JS,自动化,测试">
<meta property="og:type" content="article">
<meta property="og:title" content="基于karma+jasmine的web前端自动化测试">
<meta property="og:url" content="https://belllee.github.io/2018/01/10/FE/test/基于karma-jasmine的web前端自动化测试/index.html">
<meta property="og:site_name" content="李忠伟的个人博客">
<meta property="og:description" content="本文介绍了基于karma+jasmine的web前端自动化测试的方案和详细操作指导。 名词解释 Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。Node.js 使用了一个事件驱动、非阻塞式 I/O 的模型，使其轻量又高效。Node.js 的包管理器 npm，是全球最大的开源库生态系统。 Karma是一个基于Node.js的JavaScript测试执行过程管理">
<meta property="og:locale" content="zh_cn">
<meta property="og:updated_time" content="2018-01-10T13:30:25.848Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基于karma+jasmine的web前端自动化测试">
<meta name="twitter:description" content="本文介绍了基于karma+jasmine的web前端自动化测试的方案和详细操作指导。 名词解释 Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。Node.js 使用了一个事件驱动、非阻塞式 I/O 的模型，使其轻量又高效。Node.js 的包管理器 npm，是全球最大的开源库生态系统。 Karma是一个基于Node.js的JavaScript测试执行过程管理">
  
    <link rel="alternate" href="/atom.xml" title="李忠伟的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">李忠伟的个人博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">记录点滴 分享成长</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">历史</a>
        
          <a class="main-nav-link" href="/2018/01/01/关于我/">关于我</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://belllee.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-FE/test/基于karma-jasmine的web前端自动化测试" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/10/FE/test/基于karma-jasmine的web前端自动化测试/" class="article-date">
  <time datetime="2018-01-10T13:24:35.000Z" itemprop="datePublished">2018-01-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      基于karma+jasmine的web前端自动化测试
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本文介绍了基于karma+jasmine的web前端自动化测试的方案和详细操作指导。</p>
<h3 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h3><ol>
<li>Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。Node.js 使用了一个事件驱动、非阻塞式 I/O 的模型，使其轻量又高效。Node.js 的包管理器 npm，是全球最大的开源库生态系统。</li>
<li>Karma是一个基于Node.js的JavaScript测试执行过程管理工具（Test Runner）。该工具可用于测试所有主流Web浏览器，也可集成到CI（Continuous integration）工具，也可和其他代码编辑器一起使用。这个测试工具的一个强大特性就是，它可以监控(Watch)文件的变化，然后自行执行，通过console.log显示测试结果。</li>
<li>Jasmine 是一个简易的JS单元测试框架。Jasmine 不依赖于任何浏览器、DOM、或者是任何 JavaScript 而存在。它适用于所有网站、Node.js 项目，或者是任何能够在 JavaScript 上面运行的程序。</li>
</ol>
<h3 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h3><ol>
<li>首先必须安装执行环境nodejs</li>
<li>安装浏览器，推荐chrome（用于运行监听程序，监听js文件变化，自动触发测试执行）</li>
<li>安装karma+jasmine<pre><code>npm install karma -g
npm install karma-jasmine -g
npm install karma-chrome-launcher -g 
npm install karma-cli -g 
npm install karma-coverage -g 
npm install karma-html-reporter -g 
</code></pre></li>
<li>安装完成后执行karma -v，检查安装是否正常</li>
</ol>
<h3 id="工程配置"><a href="#工程配置" class="headerlink" title="工程配置"></a>工程配置</h3><ol>
<li>可以使用karma init，自动生成配置文件，完成部分参数的设置，然后再手动修改。</li>
<li>当然最快的配置方法，复制下面的配置<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">		<span class="comment">// Karma configuration</span></span><br><span class="line">		<span class="comment">// Generated on Tue Nov 01 2016 14:17:00 GMT+0800 (中国标准时间)</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">		  config.set(&#123;</span><br><span class="line">		  <span class="comment">// base path that will be used to resolve all patterns (eg. files, exclude)</span></span><br><span class="line">			basePath: <span class="string">''</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// frameworks to use</span></span><br><span class="line">        <span class="comment">// available frameworks: https://npmjs.org/browse/keyword/karma-adapter</span></span><br><span class="line">        frameworks: [<span class="string">'jasmine'</span>],</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// list of files / patterns to load in the browser</span></span><br><span class="line">        <span class="comment">//需要加载入浏览器的js文件，包括基础的类库，被测试js文件和测试用例js文件</span></span><br><span class="line">        <span class="comment">//如果需要测试angular代码，比如引入angular-mock.js，给angular代码进行mock。</span></span><br><span class="line">        <span class="comment">//注意angular-mock的版本一定要和angular版本一致。可在cdn网站对应的angular版本列表中寻找</span></span><br><span class="line">        files: [</span><br><span class="line">            <span class="string">'../webapp/vender/jquery/jquery-1.10.2.min.js'</span>,</span><br><span class="line">            <span class="string">'../webapp/vender/angular/angular.min.js'</span>,</span><br><span class="line">            <span class="string">'../webapp/vender/angular/angular-ui-router.min.js'</span>,</span><br><span class="line">            <span class="string">'lib/angular-mocks.js'</span>,</span><br><span class="line">            <span class="string">'../webapp/common/*.js'</span>,</span><br><span class="line">            <span class="string">'../webapp/commont/template/*.html'</span>,</span><br><span class="line">            <span class="string">'tc/ut/**/*.js'</span></span><br><span class="line">        ],</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// list of files to exclude</span></span><br><span class="line">        exclude: [</span><br><span class="line">          <span class="comment">//'../webapp/vender/**/*.js'</span></span><br><span class="line">        ],</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// test results reporter to use</span></span><br><span class="line">        <span class="comment">// possible values: 'dots', 'progress'</span></span><br><span class="line">        <span class="comment">// available reporters: https://npmjs.org/browse/keyword/karma-reporter</span></span><br><span class="line">        <span class="comment">//这里定义输出的报告</span></span><br><span class="line">        <span class="comment">//html对应karma-html-reporter组件，输出测试用例执行报告</span></span><br><span class="line">        <span class="comment">//coverage对应karma-coverage组件，输出测试用例执行报告</span></span><br><span class="line">        reporters: [<span class="string">'progress'</span>, <span class="string">'html'</span>, <span class="string">'junit'</span>, <span class="string">'coverage'</span>],</span><br><span class="line">        junitReporter: &#123;  </span><br><span class="line">               <span class="comment">// will be resolved to basePath (in the same way as files/exclude patterns)  </span></span><br><span class="line">              outputFile: <span class="string">'report/ut/test-results.xml'</span>,</span><br><span class="line">              suite: <span class="string">'UT'</span>,</span><br><span class="line">              useBrowserName: <span class="literal">false</span> </span><br><span class="line">        &#125;,  </span><br><span class="line">        htmlReporter: &#123;</span><br><span class="line">          outputDir: <span class="string">'report/ut'</span>,</span><br><span class="line">          reportName: <span class="string">'result'</span> <span class="comment">//outputDir+reportName组成完整的输出报告格式，如没有定义，会自动生成浏览器+OS信息的文件夹，不方便读取报告</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//定义需要统计覆盖率的文件</span></span><br><span class="line">        preprocessors: &#123;</span><br><span class="line">            <span class="string">'../webapp/common/*.js'</span>:<span class="string">'coverage'</span>, </span><br><span class="line">            <span class="string">'../webapp/common/template/*.html'</span>: <span class="string">'ng-html2js'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        coverageReporter: &#123;  </span><br><span class="line">            type: <span class="string">'html'</span>, <span class="comment">//将覆盖率报告类型type设置为cobertura 或者 html</span></span><br><span class="line">            subdir:<span class="string">'coverage'</span>, <span class="comment">//dir+subdir组成完整的输出报告格式，如没有定义，会自动生成浏览器+OS信息的文件夹，不方便读取报告</span></span><br><span class="line">            dir: <span class="string">'report/ut/'</span>  <span class="comment">//代码覆盖率报告生成地址</span></span><br><span class="line">        &#125;,</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// web server port</span></span><br><span class="line">        port: <span class="number">9876</span>,</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// enable / disable colors in the output (reporters and logs)</span></span><br><span class="line">        colors: <span class="literal">true</span>,</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// level of logging</span></span><br><span class="line">        <span class="comment">// possible values: config.LOG_DISABLE || config.LOG_ERROR || config.LOG_WARN || config.LOG_INFO || config.LOG_DEBUG</span></span><br><span class="line">        logLevel: config.LOG_INFO,</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// enable / disable watching file and executing tests whenever any file changes</span></span><br><span class="line">        <span class="comment">//karma自动自动监视被测试文件和测试用用例文件，如有修改，自动重新执行测试</span></span><br><span class="line">        autoWatch: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// Continuous Integration mode</span></span><br><span class="line">        <span class="comment">// if true, Karma captures browsers, runs the tests and exits</span></span><br><span class="line">        <span class="comment">//上一个参数为true，本参数为false，，则自动监视才生效。否则执行完测试用例后自动退出</span></span><br><span class="line">        singleRun: <span class="literal">true</span>,</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// start these browsers</span></span><br><span class="line">        <span class="comment">// available browser launchers: https://npmjs.org/browse/keyword/karma-launcher</span></span><br><span class="line">        <span class="comment">//用来执行自动监听的浏览器，推荐chrome</span></span><br><span class="line">        browsers: [<span class="string">'Chrome'</span>],</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// Concurrency level</span></span><br><span class="line">        <span class="comment">// how many browser should be started simultaneous</span></span><br><span class="line">        concurrency: <span class="literal">Infinity</span>，</span><br><span class="line">       <span class="comment">//自动将模板文件路径转换页面引入路径，以便注入用例中</span></span><br><span class="line">        ngHtml2JsPreprocessor: &#123;</span><br><span class="line">             cacheIdFromPath: <span class="function"><span class="keyword">function</span>(<span class="params">filepath</span>) </span>&#123;</span><br><span class="line">                 <span class="keyword">var</span> cacheId = filepath.substr(filepath.lastIndexOf(<span class="string">'/webapp/'</span>)+<span class="number">7</span>);</span><br><span class="line">                 <span class="comment">// console.log(cacheId);</span></span><br><span class="line">                 <span class="keyword">return</span> cacheId;</span><br><span class="line">               &#125;,</span><br><span class="line">           moduleName: <span class="string">'template'</span></span><br><span class="line">        &#125;</span><br><span class="line">		&#125;)</span><br><span class="line">		&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`    </span></span><br><span class="line"><span class="string">3. 保存配置文件到测试目录</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### 测试用例编写</span></span><br><span class="line"><span class="string">#### 1、用例怎么写</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>javascript</span><br><span class="line">describe(<span class="string">"A suite of Common/common.js"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	</span><br><span class="line">	beforeAll(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="string">'beforeAll'</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">   describe(<span class="string">"extends of String"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;	</span><br><span class="line">	   <span class="keyword">var</span> expected;</span><br><span class="line">		beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			expected = <span class="string">'abcd'</span>;</span><br><span class="line">		&#125;);</span><br><span class="line">		it(<span class="string">"trim"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			expect(expected).toEqual((<span class="string">" abcd "</span>).trim());</span><br><span class="line">		&#125;);</span><br><span class="line">		it(<span class="string">"ltrim"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			expect(expected).toEqual((<span class="string">" abcd"</span>).ltrim());</span><br><span class="line">		&#125;);</span><br><span class="line">		it(<span class="string">"rtrim"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			expect(expected).toEqual((<span class="string">"abcd "</span>).rtrim());</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>上述例子中，<br>a. describe相当于一个测试套，可以嵌套。<br>b. it(‘tc name’,function(){})是一个测试用例。<br>c. beforeAll和beforeEach是预置条件，前者一个测试套执行一次，后者每个测试用例执行一次。<br>d. 当然还会有afterAll和afterEach<br>e. expect是断言</p>
<h4 id="2、-断言都有那些比较"><a href="#2、-断言都有那些比较" class="headerlink" title="2、 断言都有那些比较"></a>2、 断言都有那些比较</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Matcher实现了断言的比较操作，将Expectation传入的实际值和Matcher传入的期望值比较。任何Matcher都能通过在expect调用Matcher前加上not来实现一个否定的断言（expect(a).not().toBe(<span class="literal">false</span>);）。</span><br><span class="line">常用的Matchers有：</span><br><span class="line">toBe()：相当于= =比较。</span><br><span class="line">toNotBe():相当于! =比较。</span><br><span class="line">toBeDefined()：检查变量或属性是否已声明且赋值。</span><br><span class="line">toBeUndefined()</span><br><span class="line">toBeNull()：是否是<span class="literal">null</span>。</span><br><span class="line">toBeTruthy()：如果转换为布尔值，是否为<span class="literal">true</span>。</span><br><span class="line">toBeFalsy()</span><br><span class="line">toBeLessThan()：数值比较，小于。</span><br><span class="line">toBeGreaterThan()：数值比较，大于。</span><br><span class="line">toEqual()：相当于==，注意与toBe()的区别。一个新建的<span class="built_in">Object</span>不是（not to be）另一个新建的<span class="built_in">Object</span>，但是它们是相等（to equal）的。</span><br><span class="line">expect(&#123;&#125;).not().toBe(&#123;&#125;);</span><br><span class="line">expect(&#123;&#125;).toEqual(&#123;&#125;);</span><br><span class="line">toNotEqual()</span><br><span class="line">toContain()：数组中是否包含元素（值）。只能用于数组，不能用于对象。</span><br><span class="line">toBeCloseTo()：数值比较时定义精度，先四舍五入后再比较。</span><br><span class="line">toHaveBeenCalled()</span><br><span class="line">toHaveBeenCalledWith()</span><br><span class="line">toMatch()：按正则表达式匹配。</span><br><span class="line">toNotMatch()</span><br><span class="line">toThrow()：检验一个函数是否会抛出一个错误</span><br></pre></td></tr></table></figure>
<h4 id="3、-angular代码怎么写"><a href="#3、-angular代码怎么写" class="headerlink" title="3、 angular代码怎么写"></a>3、 angular代码怎么写</h4><p>先看例子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">describe(<span class="string">'Apply MainCtrl'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> $scope,</span><br><span class="line">      $controller,</span><br><span class="line">      $httpBackend;</span><br><span class="line">     <span class="keyword">var</span> MainCtrl;</span><br><span class="line"></span><br><span class="line">  beforeEach(<span class="built_in">module</span>(<span class="string">'applyApp'</span>));</span><br><span class="line"></span><br><span class="line">  beforeEach(inject(<span class="function"><span class="keyword">function</span>(<span class="params">_$controller_, $rootScope,  _$httpBackend_</span>) </span>&#123;</span><br><span class="line">    $scope = $rootScope.$<span class="keyword">new</span>();</span><br><span class="line">    $httpBackend = _$httpBackend_;</span><br><span class="line">    $controller = _$controller_;</span><br><span class="line">    $httpBackend.when(<span class="string">'POST'</span>, /\/api\/wxcop\/common\/record.*<span class="regexp">/).respond(&#123;&#125;);      </span></span><br><span class="line"><span class="regexp">  &#125;));</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    it('Check $scope assignments.', function() &#123;</span></span><br><span class="line"><span class="regexp">      MainCtrl = $controller('MainController', &#123;</span></span><br><span class="line"><span class="regexp">            $scope: $scope</span></span><br><span class="line"><span class="regexp">        &#125;);      </span></span><br><span class="line"><span class="regexp">      $httpBackend.flush();</span></span><br><span class="line"><span class="regexp">      $scope.gotoApplyHome();</span></span><br><span class="line"><span class="regexp">      $scope.judgeLogin();</span></span><br><span class="line"><span class="regexp">      expect($scope.typeSelect).toEqual(["单行文本","多行文本","单选","多选"]);</span></span><br><span class="line"><span class="regexp">      expect($scope.getItemItems("1,2，3")).toEqual(["1","2","3"]);</span></span><br><span class="line"><span class="regexp">    &#125;);</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br></pre></td></tr></table></figure>
<p>注意，要测试angular必须引入angular-mock。<br>说明</p>
<ol>
<li>beforeEach(module(‘applyApp’));  引入module ‘applyApp’</li>
<li>beforeEach(inject(function(<em>$controller</em>, $rootScope,  <em>$httpBackend</em>)  依赖注入和http测试打桩</li>
<li>$controller(‘MainController’,  )初始化controller</li>
<li>直接调用scope，然后执行断言</li>
</ol>
<h4 id="5、-angular的相关特性如何测试"><a href="#5、-angular的相关特性如何测试" class="headerlink" title="5、 angular的相关特性如何测试"></a>5、 angular的相关特性如何测试</h4><h5 id="1、测试函数"><a href="#1、测试函数" class="headerlink" title="1、测试函数"></a>1、测试函数</h5><p>a.  被测试代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$scope.functionTriger = <span class="literal">false</span>;</span><br><span class="line">$scope.doTest = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$scope.functionTriger = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>b. 测试用例<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'function'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">    expect($scope.functionTriger).toBeFalsy();</span><br><span class="line">    $scope.doTest();</span><br><span class="line">    expect($scope.functionTriger).toBeTruthy();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h5 id="2、测试监听"><a href="#2、测试监听" class="headerlink" title="2、测试监听"></a>2、测试监听</h5><p>a.  被测试代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$scope.watchVar = <span class="literal">false</span>;</span><br><span class="line">$scope.watchedTrigeIndex = <span class="number">0</span>;</span><br><span class="line">$scope.$watch(<span class="string">'watchVar'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $scope.watchedTrigeIndex++;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>b. 测试用例<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">    expect($scope.watchedTrigeIndex).toBe(<span class="number">0</span>);</span><br><span class="line">    $scope.watchVar = <span class="literal">true</span>;</span><br><span class="line">    $scope.$digest();</span><br><span class="line">    expect($scope.watchedTrigeIndex).toBe(<span class="number">1</span>);</span><br><span class="line">    $scope.watchVar = <span class="literal">false</span>;</span><br><span class="line">    $scope.$digest();</span><br><span class="line">    expect($scope.watchedTrigeIndex).toBe(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h5 id="3、测试广播"><a href="#3、测试广播" class="headerlink" title="3、测试广播"></a>3、测试广播</h5><p>a.  被测试代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$scope.isHaveTriger = <span class="literal">false</span>;</span><br><span class="line">$scope.$on(<span class="string">'ngRepeatFinished'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $scope.isHaveTriger = <span class="literal">true</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>b. 测试用例<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'broadcast'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">  expect($scope.isHaveTriger).toBeFalsy();</span><br><span class="line">  $scope.$broadcast(<span class="string">'ngRepeatFinished'</span>);</span><br><span class="line">  expect($scope.isHaveTriger).toBeTruthy();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h5 id="4、测试路由切换"><a href="#4、测试路由切换" class="headerlink" title="4、测试路由切换"></a>4、测试路由切换</h5><p>a.  被测试代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.config([<span class="string">'$stateProvider'</span>, <span class="string">'$urlRouterProvider'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$stateProvider, $urlRouterProvider</span>)</span>&#123;</span><br><span class="line">    $urlRouterProvider.otherwise(<span class="string">"/detail"</span>);</span><br><span class="line">    $stateProvider.state(<span class="string">'detail'</span>, &#123;</span><br><span class="line">        url:<span class="string">'/detail'</span>,</span><br><span class="line">        template:<span class="string">'&lt;p&gt;&lt;/p&gt;'</span>,</span><br><span class="line">        controller:<span class="string">'MainCtrl'</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;])</span><br></pre></td></tr></table></figure></p>
<p>b. 测试用例<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'route'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    inject(<span class="function"><span class="keyword">function</span> (<span class="params">_$injector_</span>) </span>&#123;</span><br><span class="line">      $state = _$injector_.get(<span class="string">'$state'</span>);</span><br><span class="line">    &#125;);  </span><br><span class="line">    <span class="keyword">var</span> curState = $state.get(<span class="string">'detail'</span>);</span><br><span class="line">    expect(curState.name).toEqual(<span class="string">'detail'</span>);</span><br><span class="line">    expect(curState.url).toEqual(<span class="string">'/detail'</span>);</span><br><span class="line">    expect(curState.controller).toEqual(<span class="string">'MainCtrl'</span>);</span><br><span class="line">    expect(curState.template).toEqual(<span class="string">'&lt;p&gt;&lt;/p&gt;'</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></p>
<h5 id="5、测试过滤器"><a href="#5、测试过滤器" class="headerlink" title="5、测试过滤器"></a>5、测试过滤器</h5><p>a.  被测试代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.filter(<span class="string">'myFilter'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;    </span><br><span class="line">        <span class="keyword">return</span> data + <span class="string">'lzw'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>b. 测试用例<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'filter'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  inject(<span class="function"><span class="keyword">function</span> (<span class="params">_$injector_</span>) </span>&#123;</span><br><span class="line">    $filter = _$injector_.get(<span class="string">'$filter'</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></p>
<h5 id="6、测试service"><a href="#6、测试service" class="headerlink" title="6、测试service"></a>6、测试service</h5><p>a.  被测试代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.service(<span class="string">'foo'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> thisIsPrivate = <span class="string">"Private"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getPrivate</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> thisIsPrivate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        variable: <span class="string">"This is public"</span>,</span><br><span class="line">        getPrivate: getPrivate</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>b. 测试用例<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'service'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> foo;</span><br><span class="line">    inject(<span class="function"><span class="keyword">function</span>(<span class="params">_foo_</span>) </span>&#123;</span><br><span class="line">        foo = _foo_;</span><br><span class="line">    &#125;);</span><br><span class="line">    expect(foo.variable).toBe(<span class="string">'This is public'</span>);</span><br><span class="line">    expect(foo.getPrivate()).toBe(<span class="string">'Private'</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></p>
<h5 id="7、测试指令"><a href="#7、测试指令" class="headerlink" title="7、测试指令"></a>7、测试指令</h5><p>a.  被测试代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">.directive(<span class="string">'myDirective'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        restrict: <span class="string">'A'</span>,</span><br><span class="line">        replace: <span class="literal">true</span>,</span><br><span class="line">        template: <span class="string">'&lt;p&gt;11&lt;/p&gt;'</span>,</span><br><span class="line">        link: <span class="function"><span class="keyword">function</span>(<span class="params">scope</span>) </span>&#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)</span><br><span class="line">.directive(<span class="string">'dirButton'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        template: <span class="string">'&lt;button&gt;Increment value!&lt;/button&gt;'</span>,</span><br><span class="line">        link: <span class="function"><span class="keyword">function</span> (<span class="params">scope, elem</span>) </span>&#123;</span><br><span class="line">            elem.find(<span class="string">'button'</span>).on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                scope.value++;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)</span><br><span class="line">.directive(<span class="string">'dirScope'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        scope:&#123;</span><br><span class="line">            config: <span class="string">'='</span>,</span><br><span class="line">            notify: <span class="string">'@'</span>,</span><br><span class="line">            onChange:<span class="string">'&amp;'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        link: <span class="function"><span class="keyword">function</span>(<span class="params">scope</span>)</span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>b. 测试用例<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'directive'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;    </span><br><span class="line">    <span class="keyword">var</span> link = $compile(<span class="string">'&lt;p my-directive&gt;&lt;/p&gt;'</span>);</span><br><span class="line">    <span class="keyword">var</span> element = link($scope);</span><br><span class="line">    expect($(element).html()).toBe(<span class="string">'11'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  it(<span class="string">'button directive'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> directiveElem = $compile(<span class="string">'&lt;button dir-button&gt;&lt;/button&gt;'</span>)($scope);</span><br><span class="line">    $scope.value=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">var</span> button = directiveElem.find(<span class="string">'button'</span>);</span><br><span class="line">    button.triggerHandler(<span class="string">'click'</span>);</span><br><span class="line">    $scope.$digest();</span><br><span class="line">    expect($scope.value).toEqual(<span class="number">11</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  it(<span class="string">'scope directive'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $scope.config = &#123;</span><br><span class="line">      prop: <span class="string">'value'</span></span><br><span class="line">    &#125;;</span><br><span class="line">    $scope.notify = <span class="literal">true</span>;</span><br><span class="line">    $scope.onChange = jasmine.createSpy(<span class="string">'onChange'</span>);</span><br><span class="line">    <span class="keyword">var</span> directiveElem = $compile(angular.element(<span class="string">'&lt;p dir-scope config="config" notify="notify" on-change="onChange()"&gt;&lt;/p&gt;'</span>))($scope);</span><br><span class="line">    $scope.$digest();</span><br><span class="line">    <span class="keyword">var</span> isolatedScope = directiveElem.isolateScope();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//test =    </span></span><br><span class="line">    isolatedScope.config.prop = <span class="string">"value2"</span>;</span><br><span class="line">    expect($scope.config.prop).toEqual(<span class="string">'value2'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//test @</span></span><br><span class="line">    isolatedScope.notify = <span class="literal">false</span>;</span><br><span class="line">    expect($scope.notify).toEqual(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//test &amp;</span></span><br><span class="line">    expect(<span class="keyword">typeof</span>(isolatedScope.onChange)).toEqual(<span class="string">'function'</span>);</span><br><span class="line">    isolatedScope.onChange();</span><br><span class="line">    expect($scope.onChange).toHaveBeenCalled();</span><br><span class="line">	</span><br><span class="line">   <span class="comment">//调用指令的父controller。</span></span><br><span class="line">   directiveElem.scope().doFunction();</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="关于mock"><a href="#关于mock" class="headerlink" title="关于mock"></a>关于mock</h3><h4 id="httpBackend"><a href="#httpBackend" class="headerlink" title="$httpBackend"></a>$httpBackend</h4><p>$httpBackend对于代码中的http请求进行mock。常用方法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$httpBackend.when(method, url, [data], [headers]);</span><br><span class="line">$httpBackend.expect(method, url, [data], [headers]);</span><br></pre></td></tr></table></figure></p>
<p>when和expect都有对应的快捷方法:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">whenGET(url, [headers]);</span><br><span class="line">whenHEAD(url, [headers]);</span><br><span class="line">whenDELETE(url, [headers]);</span><br><span class="line">whenPOST(url, [data], [headers]);</span><br><span class="line">whenPUT(url, [data], [headers]);</span><br><span class="line">whenJSONP(url);</span><br><span class="line">expectGET(url, [headers]);</span><br><span class="line">expectHEAD(url, [headers]);</span><br><span class="line">expectDELETE(url, [headers]);</span><br><span class="line">expectPOST(url, [data], [headers]);</span><br><span class="line">expectPUT(url, [data], [headers]);</span><br><span class="line">expectPATCH(url, [data], [headers]);</span><br><span class="line">expectJSONP(url);</span><br></pre></td></tr></table></figure></p>
<p>url支持正则，比如：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$httpBackend.when(<span class="string">'POST'</span>, /\/api\/wxcop\/common\/record.*<span class="regexp">/).respond(&#123;&#125;);</span></span><br></pre></td></tr></table></figure></p>
<p>注意：<br>$httpBackend.when与$httpBackend.expect的区别在于：$httpBackend.expect的伪后台只能被调用一次(调用一次后会被清除)，第二次调用就会报错，而且$httpBackend.resetExpectations可以移除所有的expect而对when没有影响。</p>
<h3 id="常见异常处理"><a href="#常见异常处理" class="headerlink" title="常见异常处理"></a>常见异常处理</h3><h5 id="Argument-‘MainCtrl’-is-not-a-function-got-undefined"><a href="#Argument-‘MainCtrl’-is-not-a-function-got-undefined" class="headerlink" title="Argument ‘MainCtrl’ is not a function, got undefined"></a>Argument ‘MainCtrl’ is not a function, got undefined</h5><p>无法找到MainCtrl。可能原因：controller定义错误，app注入失败。</p>
<h5 id="Disconnected-because-no-message-in-10000-ms"><a href="#Disconnected-because-no-message-in-10000-ms" class="headerlink" title="Disconnected, because no message in 10000 ms."></a>Disconnected, because no message in 10000 ms.</h5><p>ajax请求超时。原因：$httpBackend.flush();要放在ajax发起请求后执行。</p>
<h5 id="指令采用templateUrl方式加载模板失败"><a href="#指令采用templateUrl方式加载模板失败" class="headerlink" title="指令采用templateUrl方式加载模板失败"></a>指令采用templateUrl方式加载模板失败</h5><p>可采用karma-ng-html2js-preprocessor插件自动注入。也可以采用$templateCache注入。注意，这两种方式都不支持模糊匹配</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://www.sitepoint.com/angular-testing-tips-testing-directives/" title="《AngularJS Testing Tips: Testing Directives》" target="_blank" rel="noopener">《AngularJS Testing Tips: Testing Directives》</a><br><a href="https://www.sitepoint.com/unit-testing-angularjs-services-controllers-providers/" target="_blank" rel="noopener">《Unit Testing in AngularJS: Services, Controllers &amp; Providers》</a><br><a href="https://nathanleclaire.com/blog/2014/04/12/unit-testing-services-in-angularjs-for-fun-and-for-profit/" target="_blank" rel="noopener">《Unit Testing Services in AngularJS for Fun and for Profit》</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://belllee.github.io/2018/01/10/FE/test/基于karma-jasmine的web前端自动化测试/" data-id="cjc95ci4e000r80cm915rhvhc" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JS/">JS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/工具/">工具</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/测试/">测试</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/自动化/">自动化</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/01/10/FE/js/高性能JavaScript-JS加载和执行/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Récent</strong>
      <div class="article-nav-title">
        
          高性能JavaScript--JS加载和执行
        
      </div>
    </a>
  
  
    <a href="/2018/01/10/FE/test/使用Protractor进行web功能测试/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Ancien</strong>
      <div class="article-nav-title">使用Protractor进行web功能测试</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Mot-clés</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS/">JS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/db/">db</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能/">性能</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/敏捷/">敏捷</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/测试/">测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自动化/">自动化</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Nuage de mot-clés</h3>
    <div class="widget tagcloud">
      <a href="/tags/JS/" style="font-size: 20px;">JS</a> <a href="/tags/db/" style="font-size: 10px;">db</a> <a href="/tags/java/" style="font-size: 16.67px;">java</a> <a href="/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/tags/工具/" style="font-size: 16.67px;">工具</a> <a href="/tags/性能/" style="font-size: 16.67px;">性能</a> <a href="/tags/敏捷/" style="font-size: 10px;">敏捷</a> <a href="/tags/测试/" style="font-size: 13.33px;">测试</a> <a href="/tags/自动化/" style="font-size: 13.33px;">自动化</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/01/10/java/EffectiveJava--创建和销毁对象/">EffectiveJava--对象的通用方法</a>
          </li>
        
          <li>
            <a href="/2018/01/10/java/EffectiveJava--对象的通用方法/">EffectiveJava--对象的通用方法</a>
          </li>
        
          <li>
            <a href="/2018/01/10/db/mongodb的internalQueryExecMaxBlockingSortBytes异常修复/">mongodb的internalQueryExecMaxBlockingSortBytes异常修复</a>
          </li>
        
          <li>
            <a href="/2018/01/10/java/非maven的jar包怎么引入maven工程/">非maven的jar包怎么引入maven工程</a>
          </li>
        
          <li>
            <a href="/2018/01/10/swe/也谈TDD/">也谈TDD</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 belllee.github.io<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">历史</a>
  
    <a href="/2018/01/01/关于我/" class="mobile-nav-link">关于我</a>
  
</nav>
    

<script src="https://cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>